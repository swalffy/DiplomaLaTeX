\begin{lstlisting}[language=Kotlin, captionpos=b,
label={lis:android-subscription},
caption={Пример реализации подписки на ViewModel}
]
productsListViewModel.model.observe(viewLifecycleOwner) {
  when (it) {
    is Loading -> onLoading()
    is NoData -> {
      onLoadingStopped()
      list_products.visibility = GONE
      text_no_data.visibility = VISIBLE
    }
    is DataReady -> {
      adapter.cleanAddAll(it.products)
      onLoadingStopped()
      text_no_data.visibility = GONE
      list_products.visibility = VISIBLE
    }
  }
}
\end{lstlisting}